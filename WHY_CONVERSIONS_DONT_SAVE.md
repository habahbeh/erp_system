# ููุงุฐุง ุงูุชุญูููุงุช ูุง ุชูุญูุธุ - ุชุญููู ุดุงูู

**ุงููุดููุฉ ุงูููุจูุบ ุนููุง**: ุนูุฏ ุฅุถุงูุฉ ุชุญููู โ ุญูุธ โ ุฅุนุงุฏุฉ ูุชุญ ุงูุตูุญุฉ โ **ุงูุชุญููู ุบูุฑ ููุฌูุฏ**

---

## ๐ ุงูุชุญููู ุงููุญุชูู ูููุดููุฉ

ููุงู **5 ุงุญุชูุงูุงุช**:

---

### ุงูุงุญุชูุงู 1: ุงูุจูุงูุงุช ูุง ุชูุฑุณู ูู POST โ

**ุงูุฃุนุฑุงุถ**:
- Logs ุชุนุฑุถ: `Found 0 conversion fields in POST data`

**ุงูุณุจุจ**:
ุงูุญููู (inputs, selects) ุงูุชู ุฃูุดุฃูุง JavaScript **ููุณุช ุฏุงุฎู `<form>` tag**

**ููู ูุญุฏุซ**:
```html
<form id="wizardForm">
    <!-- ูุญุชูู ุงูููุฑู -->
</form>

<!-- โ ุงูุฌุฏูู ููุง - ุฎุงุฑุฌ ุงูููุฑู! -->
<table id="conversionsTable">
    <tbody id="conversionsBody">
        <!-- ุงูุตููู ุงููุถุงูุฉ ุจู JavaScript ููุง -->
    </tbody>
</table>
```

**ุงูุญู**:
ุชุฃูุฏ ุฃู `conversionsTable` **ุฏุงุฎู** `<form>` tag

**ุงูุชุญูู**:
- ุงูุชุญ ุงููุชุตูุญ โ F12 โ Elements
- ุงุจุญุซ ุนู `<table id="conversionsTable">`
- ุชุฃูุฏ ุฃูู ุฏุงุฎู `<form id="wizardForm">`

---

### ุงูุงุญุชูุงู 2: ุงูุจูุงูุงุช ุชูุฑุณู ููู ุจุฃุณูุงุก ุฎุงุทุฆุฉ โ

**ุงูุฃุนุฑุงุถ**:
- Logs ุชุนุฑุถ: `Found 1 conversion fields` ููู `Skipping - missing data`

**ุงูุณุจุจ**:
ุงุณู ุญูู `conversion_from_uom_X` ููุฌูุฏุ ููู `conversion_factor_X` ุบูุฑ ููุฌูุฏ (ุฃู ุงูุนูุณ)

**ููู ูุญุฏุซ**:
```javascript
// โ ุฎุทุฃ ูู ุงูุชุณููุฉ
row.innerHTML = `
    <select name="conversion_from_uom_${index}">...</select>
    <input name="conversion_factor_WRONG_${index}">  <!-- ุงุณู ุฎุงุทุฆ! -->
`;
```

**ุงูุญู**:
ุชุฃูุฏ ุฃู ุงูุฃุณูุงุก **ูุชุทุงุจูุฉ ุชูุงูุงู**:
- `conversion_from_uom_0`
- `conversion_factor_0`

**ุงูุชุญูู**:
- ุฃุถู ุชุญููู
- F12 โ Console โ ุงูุชุจ:
```javascript
document.querySelectorAll('[name^="conversion_"]').forEach(el => {
    console.log(el.name, el.value);
});
```

---

### ุงูุงุญุชูุงู 3: ุงูุจูุงูุงุช ุชูุฑุณู ูุชูุญูุธุ ููู ูุง ุชูุณุชุฑุฌุน โ

**ุงูุฃุนุฑุงุถ**:
- Logs ุชุนุฑุถ: `โ Saved conversion`
- ูุงุนุฏุฉ ุงูุจูุงูุงุช ุชุญุชูู ุนูู ุงูุจูุงูุงุช
- ููู ุนูุฏ ุฅุนุงุฏุฉ ูุชุญ ุงูุตูุญุฉุ ุงูุฌุฏูู ูุงุฑุบ!

**ุงูุณุจุจ**:
ุงููุดููุฉ ูู ุฏุงูุฉ `get_context_data` ูู ItemUpdateView - ูุง ุชุฑุณู ุงูุชุญูููุงุช ูู template

**ุงูุญู**:
ุชุญูู ูู:
```python
context['existing_conversions_json'] = json.dumps(conversions_data)
```

**ุงูุชุญูู**:
- ุงูุชุญ ุงูุตูุญุฉ
- F12 โ Console โ ุงูุชุจ:
```javascript
console.log('Existing conversions:', existingConversions);
```
- ุฅุฐุง ูุงูุช ุงููุชูุฌุฉ `undefined` โ ุงููุดููุฉ ูู context

---

### ุงูุงุญุชูุงู 4: JavaScript ูุง ูุญููู ุงูุชุญูููุงุช ุงูููุฌูุฏุฉ โ

**ุงูุฃุนุฑุงุถ**:
- ูุงุนุฏุฉ ุงูุจูุงูุงุช ุชุญุชูู ุนูู ุงูุจูุงูุงุช
- Context ูุฑุณู ุงูุจูุงูุงุช
- ููู JavaScript ูุง ูููุดุฆ ุงูุตููู

**ุงูุณุจุจ**:
ุงูููุฏ ุงูุฐู ูุญููู ุงูุชุญูููุงุช ุงูููุฌูุฏุฉ ูุง ููููุฐ

**ุงูุญู**:
ุชุญูู ูู:
```javascript
{% if existing_conversions_json %}
existingConversions.forEach((conversion, idx) => {
    // ุฅูุดุงุก ุตู ููู ุชุญููู
});
{% endif %}
```

**ุงูุชุญูู**:
- ุงูุชุญ ุงูุตูุญุฉ
- F12 โ Console โ ุงุจุญุซ ุนู:
  - `๐ Loading existing conversions...`
  - `โ Conversion 1 loaded successfully`

---

### ุงูุงุญุชูุงู 5: ุงูุญููู ููุฌูุฏุฉ ููู disabled ุฃู readonly โ

**ุงูุฃุนุฑุงุถ**:
- ุงูุญููู ุชุธูุฑ ูู form
- ููู ุงูููู ูุง ุชูุฑุณู

**ุงูุณุจุจ**:
ุงูุญููู `disabled` ูุง ุชูุฑุณู ูู POST

**ุงูุญู**:
ุงุณุชุฎุฏู `readonly` ุจุฏูุงู ูู `disabled` (ุฃู ูุง ุชุณุชุฎุฏู ุฃู ููููุง)

**ุงูุชุญูู**:
```javascript
document.querySelectorAll('[name^="conversion_"]').forEach(el => {
    console.log(el.name, el.disabled, el.value);
});
```

---

## ๐ฏ ุงูุฎุทุฉ ูุญู ุงููุดููุฉ

### ุงูุฎุทูุฉ 1: ุฃุถูุช Logging ุดุงูู โ

ุงูุขู `save_uom_conversions()` ุณุชูุฎุจุฑู ุจุงูุถุจุท:
- ูู ุญูู ุชุญููู ููุฌุฏ ูู POST
- ูุง ูู ุฃุณูุงุฆูู
- ูุง ูู ููููู
- ูู ุชู ุญูุธูุง
- ุฅุฐุง ูุดูุชุ ููุงุฐุง

### ุงูุฎุทูุฉ 2: ุงุฎุชุจุฑ ูุฑุงูุจ django.log โณ

ุงุชุจุน ุงูุชุนูููุงุช ูู `TEST_CONVERSION_SAVE.md`

### ุงูุฎุทูุฉ 3: ุฃุฑุณู ูู ูุชูุฌุฉ django.log โณ

ุจูุงุกู ุนูู ุงูุฑุณุงุฆูุ ุณุฃุนุฑู **ุจุงูุถุจุท** ูุง ุงููุดููุฉ

### ุงูุฎุทูุฉ 4: ุฃุตูุญ ุงููุดููุฉ โณ

ุญุณุจ ุงูุณุจุจ:
- ุฅุฐุง ูุงูุช ุงูุจูุงูุงุช ูุง ุชูุฑุณู โ ุฃุตูุญ template
- ุฅุฐุง ูุงูุช ุงูุฃุณูุงุก ุฎุงุทุฆุฉ โ ุฃุตูุญ JavaScript
- ุฅุฐุง ูุงูุช ุงูุจูุงูุงุช ุชูุญูุธ ููู ูุง ุชูุณุชุฑุฌุน โ ุฃุตูุญ context
- ุฅุฐุง ูุงู JavaScript ูุง ูุญููู ุงูุจูุงูุงุช โ ุฃุตูุญ ุงูููุฏ

---

## ๐ ูุฎุทุท ุงูุชุฏูู

```
ุงููุณุชุฎุฏู ูุถุบุท "ุญูุธ"
         โ
ูู ุงูุญููู ุฏุงุฎู <form>ุ
   โโ ูุง โ โ ุงูุจูุงูุงุช ูุง ุชูุฑุณู
   โโ ูุนู โ
         โ
ูู ุงูุฃุณูุงุก ุตุญูุญุฉุ
   โโ ูุง โ โ ูุง ุชูุญูุธ (missing data)
   โโ ูุนู โ
         โ
ูู ุงูููู ููููุฃุฉุ
   โโ ูุง โ โ ูุง ุชูุญูุธ (empty)
   โโ ูุนู โ
         โ
ูู save_uom_conversions() ุชูุณุชุฏุนูุ
   โโ ูุง โ โ ูุง ุชูุญูุธ
   โโ ูุนู โ
         โ
โ ุชูุญูุธ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
         โ
ุนูุฏ ุฅุนุงุฏุฉ ุงููุชุญ:
         โ
ูู context ูุฑุณู ุงูุจูุงูุงุชุ
   โโ ูุง โ โ ูุง ุชุธูุฑ
   โโ ูุนู โ
         โ
ูู JavaScript ูุญููู ุงูุจูุงูุงุชุ
   โโ ูุง โ โ ูุง ุชุธูุฑ
   โโ ูุนู โ
         โ
โ ุชุธูุฑ ุงูุชุญูููุงุช
```

---

## ๐ง ุฃุฏูุงุช ุงูุชุดุฎูุต

### ุฃุฏุงุฉ 1: ูุญุต POST data

ูู templateุ ุฃุถู:
```html
<script>
document.getElementById('wizardForm').addEventListener('submit', function(e) {
    const formData = new FormData(this);
    console.log('=== POST Data ===');
    for (let [key, value] of formData.entries()) {
        if (key.includes('conversion')) {
            console.log(key, '=', value);
        }
    }
});
</script>
```

### ุฃุฏุงุฉ 2: ูุญุต ูุงุนุฏุฉ ุงูุจูุงูุงุช

```bash
python manage.py shell -c "
from apps.core.models import UoMConversion
conversions = UoMConversion.objects.filter(item_id=44)
print(f'ุนุฏุฏ ุงูุชุญูููุงุช: {conversions.count()}')
for c in conversions:
    print(f'  {c.from_uom.name} โ {c.conversion_factor}')
"
```

### ุฃุฏุงุฉ 3: ูุญุต context

ูู template:
```html
<script>
console.log('existing_conversions_json:', {{ existing_conversions_json|safe }});
</script>
```

---

## โ ูุชู ูุนุฑู ุฃู ุงููุดููุฉ ุญูููุชุ

ุนูุฏูุง:
1. โ Logs ุชุนุฑุถ: `โ Saved conversion: ... โ ...`
2. โ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุชุญุชูู ุนูู ุงูุชุญููู
3. โ ุนูุฏ ุฅุนุงุฏุฉ ูุชุญ ุงูุตูุญุฉุ ุงูุชุญููู ูุธูุฑ ูู ุงูุฌุฏูู
4. โ ูููู ุชุนุฏูู ุงูุชุญููู ูุญูุธู ูุฑุฉ ุฃุฎุฑู
5. โ ูููู ุญุฐู ุงูุชุญููู ูุญูุธู

---

**ุงูุขู: ูููุฐ ุงูุงุฎุชุจุงุฑ ูู `TEST_CONVERSION_SAVE.md` ูุฃุฑุณู ูู ูุชูุฌุฉ django.log!** ๐
