{# templates/includes/sidebar.html #}
{% load i18n static %}
<nav id="sidebar" class="col-md-3 col-lg-2 d-md-block bg-light sidebar">
    <div class="position-sticky pt-3">
        <ul class="nav flex-column">
            <!-- الرئيسية -->
            <li class="nav-item">
                <a class="nav-link {% if request.resolver_match.url_name == 'dashboard' %}active{% endif %}"
                   href="{% url 'core:dashboard' %}">
                    <i class="fas fa-home"></i> {% trans "الرئيسية" %}
                </a>
            </li>

            <!-- البيانات الأساسية -->
            {% if perms.base_data or user.is_superuser %}
            <h6 class="sidebar-heading px-3 mt-4 mb-1 text-muted">
                <span>{% trans "البيانات الأساسية" %}</span>
            </h6>

                {% if perms.base_data.view_customer or user.is_superuser %}
                    <li class="nav-item">
                        <a class="nav-link {% if request.resolver_match.url_name == 'customer_list' %}active{% endif %}"
                           href="{% url 'base_data:customer_list' %}">
                            <i class="fas fa-users"></i> {% trans "العملاء" %}
                        </a>
                    </li>
                {% endif %}

                {% if perms.base_data.view_supplier or user.is_superuser %}
                    <li class="nav-item">
                        <a class="nav-link {% if request.resolver_match.url_name == 'supplier_list' %}active{% endif %}"
                           href="{% url 'base_data:supplier_list' %}">
                            <i class="fas fa-truck"></i> {% trans "الموردين" %}
                        </a>
                    </li>
                {% endif %}

                {% if perms.base_data.view_item or user.is_superuser %}
                    <li class="nav-item">
                        <a class="nav-link {% if request.resolver_match.url_name == 'item_list' %}active{% endif %}"
                           href="{% url 'base_data:item_list' %}">
                            <i class="fas fa-boxes"></i> {% trans "الأصناف" %}
                        </a>
                    </li>
                {% endif %}

            {% if perms.accounting.view_account or user.is_superuser %}
            <li class="nav-item">
                <a class="nav-link" href="#">
                    <i class="fas fa-sitemap"></i> {% trans "دليل الحسابات" %}
                </a>
            </li>
            {% endif %}

            {% if perms.inventory.view_warehouse or user.is_superuser %}
            <li class="nav-item">
                <a class="nav-link" href="#">
                    <i class="fas fa-warehouse"></i> {% trans "المستودعات" %}
                </a>
            </li>
            {% endif %}
            {% endif %}

            <!-- العمليات -->
            {% if perms.purchases or perms.sales or perms.inventory or perms.accounting or user.is_superuser %}
            <h6 class="sidebar-heading px-3 mt-4 mb-1 text-muted">
                <span>{% trans "العمليات" %}</span>
            </h6>

            {% if perms.purchases.view_purchaseorder or user.is_superuser %}
            <li class="nav-item">
                <a class="nav-link" href="#">
                    <i class="fas fa-shopping-cart"></i> {% trans "المشتريات" %}
                </a>
            </li>
            {% endif %}

            {% if perms.sales.view_salesinvoice or user.is_superuser %}
            <li class="nav-item">
                <a class="nav-link" href="#">
                    <i class="fas fa-cash-register"></i> {% trans "المبيعات" %}
                </a>
            </li>
            {% endif %}

            {% if perms.inventory.view_stockmovement or user.is_superuser %}
            <li class="nav-item">
                <a class="nav-link" href="#">
                    <i class="fas fa-dolly"></i> {% trans "حركة المخزون" %}
                </a>
            </li>
            {% endif %}

            {% if perms.accounting.view_journalentry or user.is_superuser %}
            <li class="nav-item">
                <a class="nav-link" href="#">
                    <i class="fas fa-calculator"></i> {% trans "القيود اليومية" %}
                </a>
            </li>
            {% endif %}
            {% endif %}

            <!-- التقارير -->
            {% if perms.reports or user.is_superuser %}
            <h6 class="sidebar-heading px-3 mt-4 mb-1 text-muted">
                <span>{% trans "التقارير" %}</span>
            </h6>

            {% if perms.reports.view_sales_report or user.is_superuser %}
            <li class="nav-item">
                <a class="nav-link" href="#">
                    <i class="fas fa-chart-bar"></i> {% trans "تقارير المبيعات" %}
                </a>
            </li>
            {% endif %}

            {% if perms.reports.view_inventory_report or user.is_superuser %}
            <li class="nav-item">
                <a class="nav-link" href="#">
                    <i class="fas fa-chart-pie"></i> {% trans "تقارير المخزون" %}
                </a>
            </li>
            {% endif %}

            {% if perms.reports.view_financial_report or user.is_superuser %}
            <li class="nav-item">
                <a class="nav-link" href="#">
                    <i class="fas fa-file-invoice-dollar"></i> {% trans "التقارير المالية" %}
                </a>
            </li>
            {% endif %}
            {% endif %}

            <!-- الإدارة -->
            {% if perms.core.view_user or perms.core.view_auditlog or user.is_superuser %}
            <h6 class="sidebar-heading px-3 mt-4 mb-1 text-muted">
                <span>{% trans "الإدارة" %}</span>
            </h6>

            {% if perms.core.view_user or user.is_superuser %}
            <li class="nav-item">
                <a class="nav-link" href="#">
                    <i class="fas fa-user-shield"></i> {% trans "المستخدمين" %}
                </a>
            </li>
            {% endif %}

            {% if perms.auth.view_permission or user.is_superuser %}
            <li class="nav-item">
                <a class="nav-link" href="#">
                    <i class="fas fa-user-tag"></i> {% trans "الصلاحيات" %}
                </a>
            </li>
            {% endif %}

            {% if perms.core.view_auditlog or user.is_superuser %}
            <li class="nav-item">
                <a class="nav-link" href="#">
                    <i class="fas fa-history"></i> {% trans "سجل العمليات" %}
                </a>
            </li>
            {% endif %}

            {% if user.is_superuser %}
            <li class="nav-item">
                <a class="nav-link" href="{% url 'admin:index' %}">
                    <i class="fas fa-cogs"></i> {% trans "لوحة التحكم" %}
                </a>
            </li>
            {% endif %}
            {% endif %}
        </ul>

        <!-- معلومات النظام -->
        <div class="mt-5 mb-3 px-3 text-muted small">
            <hr>
            <p class="mb-1">{% trans "الإصدار" %}: 1.0.0</p>
            <p class="mb-0">&copy; 2024 {% trans "نظام ERP" %}</p>
        </div>
    </div>
</nav>